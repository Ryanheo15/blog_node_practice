<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css"
          integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Custom CSS -->
    <link rel = "stylesheet" href = "/styles/style.css">

    <title>Blog</title>
</head>

<body>

<main class = "post-main">
  <div class = "row">
    <div class = "col-md-4 pt-5">
      <div class = "container pl-5">
      <h1 class = "display-4">CODE BLOG</h4>

      <ul class = "navbar-nav">
        <li class="nav-item active mt-4">
          <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
        </li>

        <li class="nav-item mt-4">
          <a class="nav-link" href="#">About Me</a>
        </li>

        <li class="nav-item mt-4">
          <a class="nav-link" href="#">Posts</a>
        </li>

        <li class="nav-item mt-4">
          <a class="nav-link" href="#">Contact Me</a>
        </li>
      </ul>
    </div>
    </div>

    <div class = "col-md-8 pb-5 pt-5">

      <div class = "new_post text-right">
        <a class = "btn btn-success " href = "/posts/new">
          + New Post
        </a>
      </div>

      <% for(let i = 0; i < posts.length; i++) { %>
      <div class="card mt-4 pt-4 pb-4 blog_card">
        <div class="card-body">
          <form method = "POST" action = "/posts/<%= posts[i].id %>?_method=DELETE">
            <button class = "btn btn-danger float-right">X</button>
          </form>
          <h5 class="card-title"><%= posts[i].title %></h5>
          <h7 class = "text-secondary"><%= posts[i].author %></h7>
          <div class = "d-flex mt-4 blog-summary">
            <div class = "col-md-4">
              <img class = "img-fluid blog-img" src = "<%= posts[i].image %>">
            </div>

            <div class = "col-md-8">
              <% let post_content = posts[i].content; %>
              <% if(posts[i].content.length > 100) { %>
              <%  post_content = posts[i].content.split(" ").splice(0, 100).join(" "); %>
              <%  } %>
              <p class="card-text post_content">
                <%= post_content %>
              </p>
            </div>
          </div>

          <div class = "post_btns">
            <a href= "/posts/<%= posts[i]._id %>" class="btn btn-primary mt-4 float-right">Read More</a>

            <a href= "/posts/<%= posts[i]._id %>/edit" class="btn btn-info mt-4 float-right mr-4">Edit</a>
          </div>
        </div>
      </div>
      <% } %>

      </div>
    </div>
</main>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.15.0/umd/popper.min.js"
        integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

<script src = "/js/client_post.js"></script>
</body>
</html>
